<div>
  <h1>Embed this in your HTML file !</h1>
  <p>
    &lt;script type="text/javascript">
      var CLIENT_ID = '673381173216-1cg3p0mqapitdm647sqtn8umspgnncln';
      var API_KEY = 'AIzaSyBejq9v2EcnUSjL5aR5CJ2jpOn_NL3oHoA';
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          putItIn(</p><%= "'"+@spreadsheet.name+"'" %>,<%= @col_arr %>,<%= @name_arr %> <p>);
        });
      }
          
      function putItIn(spreadsheet_id, ranges, tag_name) {
        gapi.client.sheets.spreadsheets.values.batchGet({
          spreadsheetId: spreadsheet_id,
          ranges: ranges,
        }).then(function(response) {
          var result = response.result;
          if (result.valueRanges.length > 0) {
            for (i = 0; i < result.valueRanges.length; i++) {
              for (j = 0; j < result.valueRanges[i].values.length; j++) {
                var row = result.valueRanges[i].values[j];
                var tags = document.getElementsByTagName(tag_name[i]);
                k = 0;
                while(k < tags.length){
                  if(tags[k].id == j){
                    tags[k].innerHTML = row[0];
                  }
                  k++;
                }
              }
            }
          } else {
            document.getElementsByTagName(tag_name[i])[0].innerHTML = 'No data found.';
          }
        }, function(response) {
          var textnode = document.createTextNode('Error: ' + response.result.error.message);
          document.getElementsByTagName(tag_name[i])[0].parentNode.appendChild(textnode);
        });
      }
    &lt;/script>
  
    &lt;script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    &lt;/script>'
  </p>
</div>

